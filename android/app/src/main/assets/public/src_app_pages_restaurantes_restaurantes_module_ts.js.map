{"version":3,"file":"src_app_pages_restaurantes_restaurantes_module_ts.js","mappings":"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","sources":["./src/app/models/restaurantes.model.ts","./src/app/pages/restaurantes/restaurantes-routing.module.ts","./src/app/pages/restaurantes/restaurantes.module.ts","./src/app/pages/restaurantes/restaurantes.page.ts"],"sourcesContent":["import { HorariosModel } from 'app/models/horarios.model';\nimport { ShellModel } from '../shell/data-store';\n\nexport class RestaurantesModel extends ShellModel {\n    id: string;\n    tienda: string;\n    imagen: string;\n    posicion: number;\n    activa: boolean;\n    categoria: string;\n    correo: string;\n    politica: string;\n    telefono: string;\n    direccion: string;\n    tamano: number;\n    mishorarios: HorariosModel\n    cerrada: boolean;\n    proximamente: boolean;\n\n    constructor() {\n        super();\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { RestaurantesPage } from './restaurantes.page';\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: RestaurantesPage,\n    }\n];\n\n@NgModule({\n    imports: [RouterModule.forChild(routes)],\n    exports: [RouterModule],\n})\nexport class RestaurantesPageRoutingModule { }\n","import { IonicModule } from '@ionic/angular';\nimport { Routes } from '@angular/router';\nimport { CUSTOM_ELEMENTS_SCHEMA, NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ComponentsModule } from 'app/components/components.module';\nimport { RestaurantesPage } from 'app/pages/restaurantes/restaurantes.page';\nimport { RestaurantesPageRoutingModule } from './restaurantes-routing.module';\nimport { FirebaseService } from 'app/services/firebase.service';\nimport { FormsModule } from '@angular/forms';\n// import { InAppBrowser } from '@awesome-cordova-plugins/in-app-browser/ngx';\n\nconst restaurantesRoutes: Routes = [\n  {\n    path: '',\n    component: RestaurantesPage\n  }\n];\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    RestaurantesPageRoutingModule,\n    ComponentsModule,\n    FormsModule,\n  ],\n  declarations: [RestaurantesPage],\n  providers: [\n    FirebaseService,\n    // InAppBrowser\n  ],\n  schemas: [CUSTOM_ELEMENTS_SCHEMA]\n})\nexport class RestaurantesPageModule { }\n","import { Component, OnInit, OnDestroy, HostBinding, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup, FormControl } from '@angular/forms';\nimport { ModalController, IonRouterOutlet } from '@ionic/angular';\nimport { ActivatedRoute, Params, Router } from '@angular/router';\nimport { Observable, ReplaySubject, Subscription, merge } from 'rxjs';\nimport { switchMap, map } from 'rxjs/operators';\nimport { RestaurantesModel } from 'app/models/restaurantes.model';\nimport { DataStore, ShellModel } from 'app/shell/data-store';\nimport { CarritoService } from 'app/services/carrito.service';\nimport { CarritoPage } from 'app/pages/carrito/carrito.page';\nimport { BehaviorSubject } from 'rxjs';\nimport { BuscarPage } from '../buscar/buscar.page';\nimport { FirebaseService } from 'app/services/firebase.service';\n\n@Component({\n  selector: 'app-restaurantes',\n  templateUrl: './restaurantes.page.html',\n  styleUrls: [\n    './styles/restaurantes.page.scss',\n    './styles/restaurantes.shell.scss',\n    './styles/restaurantes.responsive.scss'\n  ]\n})\nexport class RestaurantesPage implements OnInit, OnDestroy {\n  rangeForm: FormGroup;\n  searchQuery: string;\n  showAgeFilter = false;\n  categoriaId: string;\n  categoria: string;\n  searchSubject: ReplaySubject<any> = new ReplaySubject<any>(1);\n  searchFiltersObservable: Observable<any> = this.searchSubject.asObservable();\n  restaurantesDataStore: DataStore<Array<RestaurantesModel>>;\n  stateSubscription: Subscription;\n  items: Array<RestaurantesModel> & ShellModel;\n  itemsList: Array<RestaurantesModel> & ShellModel;\n\n  @HostBinding('class.is-shell') get isShell() {\n    return (this.items && this.items.isShell) ? true : false;\n  }\n\n  cart = [];\n  products = [];\n  cartItemCount: BehaviorSubject<number>;\n\n  @ViewChild('cart', { static: false, read: ElementRef }) fab: ElementRef;\n\n  constructor(\n    public router: Router,\n    public firebaseService: FirebaseService,\n    public modalController: ModalController,\n    private route: ActivatedRoute,\n    private cartService: CarritoService,\n    private modalCtrl: ModalController\n  ) { }\n\n  ngOnDestroy(): void {\n    this.stateSubscription.unsubscribe();\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe(\n      (params: Params) => {\n        this.categoriaId = params.categoriaId;\n        this.categoria = params.categoria;\n      }\n    );\n\n    this.products = this.cartService.getProducts();\n    this.cart = this.cartService.getCart();\n    this.cartItemCount = this.cartService.getCartItemCount();\n\n    this.searchQuery = '';\n\n    this.rangeForm = new FormGroup({\n      dual: new FormControl({ lower: 1, upper: 100 })\n    });\n\n    this.route.data.subscribe(\n      (resolvedRouteData) => {\n\n        const dataSource: Observable<Array<RestaurantesModel>> = this.firebaseService.getTiendasDataSource('restaurantes');\n\n        const dataStore: DataStore<Array<RestaurantesModel>> = this.firebaseService.getTiendasStore('restaurantes', dataSource);\n\n        this.restaurantesDataStore = dataStore;\n\n        // We need to avoid having multiple firebase subscriptions open at the same time to avoid memory leaks\n        // By using a switchMap to cancel previous subscription each time a new one arrives,\n        // we ensure having just one subscription (the latest)\n        const updateSearchObservable = this.searchFiltersObservable.pipe(\n          switchMap((filters) => {\n            const filteredDataSource = this.firebaseService.searchTiendas(\n            );\n            // Send a shell until we have filtered data from Firebase\n            const searchingShellModel = [\n              new RestaurantesModel(),\n              new RestaurantesModel()\n            ];\n            // Wait on purpose some time to ensure the shell animation gets shown while loading filtered data\n            const searchingDelay = 400;\n\n            const dataSourceWithShellObservable = DataStore.AppendShell(filteredDataSource, searchingShellModel, searchingDelay);\n\n            return dataSourceWithShellObservable.pipe(\n              map(filteredItems => {\n                // Just filter items by name if there is a search query and they are not shell values\n                if (filters.query !== '' && !filteredItems.isShell) {\n                  const queryFilteredItems = filteredItems.filter(item =>\n                    item.tienda.toLowerCase().includes(filters.query.toLowerCase()\n                    ));\n                  // While filtering we strip out the isShell property, add it again\n                  return Object.assign(queryFilteredItems, { isShell: filteredItems.isShell });\n                } else {\n                  return filteredItems;\n                }\n              })\n            );\n          })\n        );\n\n        // Keep track of the subscription to unsubscribe onDestroy\n        // Merge filteredData with the original dataStore state\n        this.stateSubscription = merge(\n          this.restaurantesDataStore.state,\n          updateSearchObservable\n        ).subscribe(\n          (state) => {\n            state.forEach(element => {\n              if (element != null && element.mishorarios != null) {\n                const hora = String(\"0\" + new Date().getHours()).slice(-2) + ':' + String(\"0\" + new Date().getMinutes()).slice(-2);\n                element.cerrada = !(hora >= element.mishorarios.desde && hora <= element.mishorarios.hasta);\n                // element.mishorarios.desde = new Date('1968-11-16T' + element.mishorarios.desde).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n                // element.mishorarios.hasta = new Date('1968-11-16T' + element.mishorarios.desde).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n              }\n              else\n                element.cerrada = false;\n            });\n            this.items = state;\n            this.itemsList = state;\n            this.searchList();\n            console.log('Items de restaurantes', state);\n          },\n          (error) => console.log(error),\n          () => console.log('stateSubscription completed')\n        );\n      },\n      (error) => console.log(error)\n    );\n  }\n\n  addToCart(product) {\n    this.cartService.addProduct(product);\n  }\n\n\n  async openCart() {\n\n    let modal = await this.modalCtrl.create({\n      component: CarritoPage,\n      cssClass: 'cart-modal'\n    });\n    modal.onWillDismiss().then(() => {\n      this.fab.nativeElement.classList.remove('animated', 'bounceOutLeft')\n    });\n    modal.present();\n  }\n\n  async openSearch(titulo: string, categoriaId: string, tiendaId: string) {\n\n    let modal = await this.modalCtrl.create({\n      component: BuscarPage,\n      cssClass: 'cart-modal',\n      componentProps: {\n        'titulo': titulo,\n        'categoriaId': categoriaId,\n        'tiendaId': tiendaId\n      }\n    });\n    modal.onWillDismiss().then(() => {\n      this.fab.nativeElement.classList.remove('animated', 'bounceOutLeft')\n    });\n    modal.present();\n  }\n\n  closeModal() {\n    this.modalCtrl.dismiss();\n  }\n\n  // openTienda(tiendaId: string, tienda: string) {\n  //   if (this.categoriaId != 'colegios')\n  //     this.router.navigate(['/clases/', tiendaId, tienda], { replaceUrl: true });\n  // }\n\n  searchList() {\n    const query = (this.searchQuery && this.searchQuery !== null) ? this.searchQuery : '';\n    this.itemsList = this.filterList(this.items, query);\n  }\n\n  filterList(list, query) {\n    const lista = list.filter(item =>\n      item.tienda.toLowerCase().includes(query.toLowerCase())\n    );\n    return lista;\n  }\n\n\n}\n"],"names":["Component","HostBinding","ViewChild","ElementRef","FormGroup","FormControl","ModalController","ActivatedRoute","Router","ReplaySubject","merge","switchMap","map","RestaurantesModel","DataStore","CarritoService","CarritoPage","BuscarPage","FirebaseService","RestaurantesPage","constructor","router","firebaseService","modalController","route","cartService","modalCtrl","searchSubject","asObservable","isShell","items","ngOnDestroy","stateSubscription","unsubscribe","ngOnInit","params","subscribe","categoriaId","categoria","products","getProducts","cart","getCart","cartItemCount","getCartItemCount","searchQuery","rangeForm","dual","lower","upper","data","resolvedRouteData","dataSource","getTiendasDataSource","dataStore","getTiendasStore","restaurantesDataStore","updateSearchObservable","searchFiltersObservable","pipe","filters","filteredDataSource","searchTiendas","searchingShellModel","searchingDelay","dataSourceWithShellObservable","AppendShell","filteredItems","query","queryFilteredItems","filter","item","tienda","toLowerCase","includes","Object","assign","state","forEach","element","mishorarios","hora","String","Date","getHours","slice","getMinutes","cerrada","desde","hasta","itemsList","searchList","console","log","error","addToCart","product","addProduct","openCart","modal","create","component","cssClass","onWillDismiss","then","fab","nativeElement","classList","remove","present","openSearch","titulo","tiendaId","componentProps","closeModal","dismiss","filterList","list","lista","args","static","read","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}