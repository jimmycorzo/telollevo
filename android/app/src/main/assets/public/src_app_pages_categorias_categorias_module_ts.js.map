{"version":3,"file":"src_app_pages_categorias_categorias_module_ts.js","mappings":"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","sources":["./src/app/pages/categorias/categorias-routing.module.ts","./src/app/pages/categorias/categorias.module.ts","./src/app/pages/categorias/categorias.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { CategoriasPage } from './categorias.page';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CategoriasPage,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class CategoriasPageRoutingModule { }\n","import { IonicModule } from '@ionic/angular';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { CategoriasPage } from './categorias.page';\nimport { CategoriasPageRoutingModule } from './categorias-routing.module';\nimport { ComponentsModule } from 'app/components/components.module';\nimport { FirebaseService } from 'app/services/firebase.service';\n// import { InAppBrowser } from '@awesome-cordova-plugins/in-app-browser/ngx';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ComponentsModule,\n    IonicModule,\n    FormsModule,\n    CategoriasPageRoutingModule,\n  ],\n  declarations: [CategoriasPage],\n  providers: [\n    FirebaseService,\n    // InAppBrowser\n  ]\n})\nexport class CategoriasPageModule { }\n","import { Component, OnInit, OnDestroy, HostBinding, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup, FormControl } from '@angular/forms';\nimport { ModalController, IonRouterOutlet } from '@ionic/angular';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Observable, ReplaySubject, Subscription, merge, BehaviorSubject } from 'rxjs';\nimport { switchMap, map } from 'rxjs/operators';\nimport { CategoriasModel } from 'app/models/categorias.model';\nimport { DataStore, ShellModel } from 'app/shell/data-store';\nimport { CarritoService } from 'app/services/carrito.service';\nimport { CarritoPage } from 'app/pages/carrito/carrito.page';\nimport { DireccionesModel } from 'app/models/direcciones.model';\nimport { environment } from '@env/environment';\nimport { FirebaseService } from 'app/services/firebase.service';\n// import { MapsPage } from '../maps/maps.page';\n\n@Component({\n  selector: 'app-categorias',\n  templateUrl: 'categorias.page.html',\n  styleUrls: [\n    './styles/categorias.page.scss',\n    './styles/categorias.shell.scss',\n    './styles/categorias.responsive.scss'\n  ]\n})\n\nexport class CategoriasPage implements OnInit, OnDestroy {\n  rangeForm: FormGroup;\n  searchQuery: string;\n  showAgeFilter = false;\n  searchSubject: ReplaySubject<any> = new ReplaySubject<any>(1);\n  searchFiltersObservable: Observable<any> = this.searchSubject.asObservable();\n  categoriasDataStore: DataStore<Array<CategoriasModel>>;\n  direccionesDataStore: DataStore<Array<DireccionesModel>>;\n  stateSubscription: Subscription;\n  direcciones: Array<DireccionesModel>;\n  items: Array<CategoriasModel> & ShellModel;\n\n  @HostBinding('class.is-shell') get isShell() {\n    return (this.items && this.items.isShell) ? true : false;\n  }\n\n  cart = [];\n  products = [];\n  cartItemCount: BehaviorSubject<number>;\n  direccionSeleccionada: DireccionesModel;\n  stateSubscriptionDirecciones: Subscription;\n  stateSubscriptionSucursales: Subscription;\n  version: string;\n\n  @ViewChild('cart', { static: false, read: ElementRef }) fab: ElementRef;\n\n  constructor(\n    public router: Router,\n    public firebaseService: FirebaseService,\n    public modalController: ModalController,\n    private route: ActivatedRoute,\n    private routerOutlet: IonRouterOutlet,\n    private cartService: CarritoService,\n    private modalCtrl: ModalController,\n  ) {\n  }\n\n  ngOnDestroy(): void {\n    this.stateSubscription.unsubscribe();\n  }\n\n  async ngOnInit() {\n    this.version = environment.version;\n\n    this.searchQuery = '';\n\n    this.rangeForm = new FormGroup({\n      dual: new FormControl({ lower: 1, upper: 100 })\n    });\n\n    this.route.data.subscribe(\n      (resolvedRouteData) => {\n\n        const dataSource: Observable<CategoriasModel[]> = this.firebaseService.getCategoriasDataSource();\n\n        const dataStore: DataStore<Array<CategoriasModel>> = this.firebaseService.getCategoriasStore(dataSource);\n\n        this.categoriasDataStore = dataStore;\n\n        const updateSearchObservable = this.searchFiltersObservable.pipe(\n          switchMap((filters) => {\n            const filteredDataSource = this.firebaseService.searchCategorias(\n              filters.texto\n            );\n            const searchingShellModel = [\n              new CategoriasModel(),\n              new CategoriasModel()\n            ];\n            const searchingDelay = 400;\n\n            const dataSourceWithShellObservable = DataStore.AppendShell(filteredDataSource, searchingShellModel, searchingDelay);\n\n            return dataSourceWithShellObservable.pipe(\n              map(filteredItems => {\n                if (filters.query !== '' && !filteredItems.isShell) {\n                  const queryFilteredItems = filteredItems.filter(item =>\n                    item.categoria.toLowerCase().includes(filters.query.toLowerCase()\n                    ));\n                  return Object.assign(queryFilteredItems, { isShell: filteredItems.isShell });\n                } else {\n                  return filteredItems;\n                }\n              })\n            );\n          })\n        );\n\n        this.stateSubscription = merge(\n          this.categoriasDataStore.state,\n          updateSearchObservable\n        ).subscribe(\n          (state) => {\n            this.items = state.filter(x => x.categoria !== 'Directorio' && x.categoria !== 'Restaurantes' && x.categoria !== 'Servicios Públicos') as Array<CategoriasModel> & ShellModel;\n            console.log('Items de tiendas', state);\n          },\n          (error) => console.log(error),\n          () => console.log('stateSubscription completed')\n        );\n      },\n      (error) => console.log(error)\n    );\n\n    this.products = this.cartService.getProducts();\n    this.cart = this.cartService.getCart();\n    this.cartItemCount = this.cartService.getCartItemCount();\n  }\n\n  searchList() {\n    this.searchSubject.next({\n      lower: this.rangeForm.controls.dual.value.lower,\n      upper: this.rangeForm.controls.dual.value.upper,\n      query: this.searchQuery\n    });\n  }\n\n  addToCart(product) {\n    this.cartService.addProduct(product);\n  }\n\n  async openCart() {\n\n    let modal = await this.modalCtrl.create({\n      component: CarritoPage,\n      cssClass: 'cart-modal'\n    });\n    modal.onWillDismiss().then(() => {\n      this.fab.nativeElement.classList.remove('animated', 'bounceOutLeft')\n    });\n    modal.present();\n  }\n\n  openTiendas(categoriaId: string, categoria: string) {\n    this.router.navigate(['/tiendas/', categoriaId, categoria], { replaceUrl: true });\n  }\n\n  direccion_seleccionada(event) {\n    if (event.detail.value == '000000') // Nueva Dirección\n    {\n      localStorage.setItem('direccion', JSON.stringify('000001'));\n      var direccion: DireccionesModel;\n      this.openMaps(direccion);\n    }\n    if (event.detail.value == '000001') // En Sitio\n    {\n      localStorage.setItem('direccion', JSON.stringify(event.detail.value));\n    }\n    else {\n      localStorage.setItem('direccion', JSON.stringify(event.detail.value));\n    }\n  }\n\n  sucursal_seleccionada(event) {\n    localStorage.setItem('sucursal', JSON.stringify(event.detail));\n  }\n\n  async openMaps(direccion: DireccionesModel) {\n    if (direccion == null) {\n      direccion = new DireccionesModel();\n    }\n    // let modal = await this.modalCtrl.create({\n    //   component: MapsPage,\n    //   cssClass: 'cart-modal',\n    //   componentProps: {\n    //     'direccion': direccion,\n    //   }\n    // });\n    // modal.onWillDismiss().then(() => {\n    //   if (direccion.id == '000000') // Nueva Dirección\n    //   {\n    //     localStorage.setItem('direccion', JSON.stringify('000001'));\n    //   }\n    //   else {\n    //     var direccion1 = JSON.parse(localStorage.getItem('direccion'));\n    //     this.direcciones = this.direcciones.concat(direccion1).sort(this.compareDirecciones);\n    //   }\n    // });\n    // modal.present();\n  }\n\n  compareSucursales(a, b) {\n    if (a.sucursal < b.sucursal) {\n      return -1;\n    }\n    if (a.sucursal > b.sucursal) {\n      return 1;\n    }\n    return 0;\n  }\n\n  compareDirecciones(a, b) {\n    if (a.direccion < b.direccion) {\n      return -1;\n    }\n    if (a.direccion > b.direccion) {\n      return 1;\n    }\n    return 0;\n  }\n}\n"],"names":["Component","HostBinding","ViewChild","ElementRef","FormGroup","FormControl","ModalController","IonRouterOutlet","ActivatedRoute","Router","ReplaySubject","merge","switchMap","map","CategoriasModel","DataStore","CarritoService","CarritoPage","DireccionesModel","environment","FirebaseService","CategoriasPage","constructor","router","firebaseService","modalController","route","routerOutlet","cartService","modalCtrl","searchSubject","asObservable","isShell","items","ngOnDestroy","stateSubscription","unsubscribe","ngOnInit","version","searchQuery","rangeForm","dual","lower","upper","data","subscribe","resolvedRouteData","dataSource","getCategoriasDataSource","dataStore","getCategoriasStore","categoriasDataStore","updateSearchObservable","searchFiltersObservable","pipe","filters","filteredDataSource","searchCategorias","texto","searchingShellModel","searchingDelay","dataSourceWithShellObservable","AppendShell","filteredItems","query","queryFilteredItems","filter","item","categoria","toLowerCase","includes","Object","assign","state","x","console","log","error","products","getProducts","cart","getCart","cartItemCount","getCartItemCount","searchList","next","controls","value","addToCart","product","addProduct","openCart","modal","create","component","cssClass","onWillDismiss","then","fab","nativeElement","classList","remove","present","openTiendas","categoriaId","navigate","replaceUrl","direccion_seleccionada","event","detail","localStorage","setItem","JSON","stringify","direccion","openMaps","sucursal_seleccionada","compareSucursales","a","b","sucursal","compareDirecciones","args","static","read","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}